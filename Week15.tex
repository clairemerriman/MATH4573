\documentclass[letterpaper, 11 pt]{article}
\input{lessonplanheader}


\newcommand{\ord}{\operatorname{ord}}

\title{Week 15--MATH 4573 Elementary Number Theory}

\begin{document}

\maketitle
\tableofcontents
%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Monday, April 19: Sums of Two Squares}
%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Finishing Fermat's Last Theorem (10 minutes)}
%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{thm}
 The Diophantine equation $x^4+y^4=z^2$ has not solutions in nonzero integers $x,y,z$.
\end{thm}
\begin{cb}
 Now why does this tell us there are no solutions to $x^4+y^4=z^4$?
\end{cb}
Note: If $x,y,z$ is a solution to $x^4+y^4=z^4$, then {$x,y,z^2$} is a solution to $x^4+y^4=z^4$. By contraposition, if $x^4+y^4=z^2$ has no solutions, then $x^4+y^4=z^4$ has no solutions. 

\begin{proof}
We assumed that there exists $x_1,y_1,z_1>0$ with $\gcd(x_1,y_1,z_1)=1$ and $x_1^4+y_1^4=z_1^2$. We found $m,n\in \Z$ with $m>n>0$, $n$ even, and  $x_1^2=m^2-n^2, y_1^2=2mn, z_1=m^2+n^2$. Now, $x_1^2=m^2-n^2$ implies $x_1^2+n^2=m^2$ and $x_1,m,n$ is a Pythagorean triple with $\gcd(x_1,m,n)=1$. 

We then found that there exists $a,b\in\mathbb{Z}$ with $\gcd(a,b)=1,a>b>0$, exactly one of $a$ and $b$ is even, with $x_1=a^2-b^2, n=2ab, m=a^2+b^2$. 

We proved that $m,a,$ and $b$ are perfect squares.

Thus, we have constructed another solution as desired. That is, we assumed the existence of a solution to $x^4+y^4=z^2$ in the positive integers, we can construct another solution with a strictly smaller value of $z$. This is a contradiction sine there are only finitely many positive integers between a given positive integer and zero. So $x^4+y^4=z^2$ has no solutions on nonzero $x,y,z$.
\end{proof}
%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Sums of Two Squares (45 minutes)}
%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{thm}[Lemma 10.1]
 Let $n_1,n_2\in\mathbb{Z}$ with $n_1,n_2>0$. If $n_1$ and $n_2$ are expressible as the sum of two squares of integers, then $n_1n_2$ is expressible as the sum of two squares of integers.
\end{thm}
\begin{example}
 Since $13=3^2+{2}^2$ and $17={4}^2+{1}^2$ are each expressible as the sum of two squares, $13*17=221={14}^2+{-5}^2$.
\end{example}
\begin{br}[5 minutes]
Prove this theorem Let $a,b,c,d\in\mathbb{Z}$ such that $n_1=a^2+b^2$ and $n_2=c^2+d^2$. Then $n_1n_2=(a^2+b^2)(c^2+d^2)=(ac+bd)^2+(ad-bc)^2$.
\end{br}

We will prove that every prime that congruent to $1 \pmod 4$ is expressible as the sum of two squares.

\begin{thm}[Primes as sums of squares]
 If $p$ is a prime such that $p\equiv 1 \pmod 4$, then there exists $x,y\in\mathbb{Z}$ such that $x^2+y^2=kp$ for some $k\in\mathbb{Z}$ and $0<k<p$.
\end{thm}
\begin{proof}
 Since $p\equiv 1 \pmod 4$, we have that $\left(\frac{-1}{p}\right)=1$. Thus, there exists $x\in\mathbb{Z}$ with $0<x\leq\frac{p-1}{2}$ such that $x^2\equiv -1 \pmod p$. Then, $p\mid x^2+1$, and we have that $x^2+1=kp$ for some $k\in\mathbb{Z}$. Thus, we found $x$ and $y=1$. Since $x^2+1$ and $p$ are positive, so is $k$. Also, \[kp=x^2+y^2<\left(\frac{p}{2}\right)^2+1<p^2\] implies $k<p$.
\end{proof}

\begin{br}[5 minutes]
 If $n\equiv 3 \pmod 4$, then $n$ cannot be written as the sum of two squares.
\end{br}
\begin{solution}
 The options for squares $\mod 4$ are $1^2\equiv 3^2\equiv 1 \pmod 4$ and $0^2\equiv 2^2\equiv 0 \pmod 4$. Then the options for $x^2+y^2$ are $0,1,2\pmod 4$.
\end{solution}

The next theorem will prove that primes $p\equiv 1 \pmod 4$ and $p=2$ can be written as the sum of two square integers.

\begin{thm}[Theorem 10.2]
 If $p$ is a prime number such that $p\not\equiv 3\pmod 4$, then $p$ is expressible as the sum of two squares of integers.
\end{thm}
\begin{proof}
 When $p=2=1^2+1^2$, we are done.
 
 Assume that $p\equiv 1\pmod 4$. Let $m$ be the least integer such that there exists $x,y\in\mathbb{Z}$ with $x^2+y^2=mp$ and $0<m<p$ as in the previous theorem. We show that $m=1$. Assume, by way of contradiction, that $m>1$. Let $a,b\in\mathbb{Z}$ such that \[a\equiv x\pmod m,\quad \frac{-m}{2}<a\leq\frac{m}{2}\] and \[b\equiv y\pmod m,\quad \frac{-m}{2}<b\leq\frac{m}{2}.\] Then \[a^2+b^2\equiv x^2+y^2=mp\equiv 0\pmod m,\] and so there exists $k\in\mathbb{Z}$ with $k>0$ such that $a^2+b^2=km$. (Why?)
 
 Now, \[(a^2+b^2)(x^2+y^2)=(km)(mp)=km^2p.\] By Lemma 10.1, $(a^2+b^2)(x^2+y^2)=(ax+by)^2+(ay-bx)^2$, so $(ax+by)^2+(ay-bx)^2=km^2p$. 
 
 %%%%%%%%%%%%%%%%%%%%%%%%%
\section{Wednesday, April 21: Sums of Two or Three Squares}
%%%%%%%%%%%%%%%%%%%%%%%%%%
{\bf Turn in }

Why can $x^2+y^2+z^2$  never be 7 mod 8?

Let $4^m(8n+7)=x^2+y^2+z^2$ for $m>0$. Why are $x,y$, and $z$ all even?
%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Finishing Sum of Two Squares (20 minutes)}
%%%%%%%%%%%%%%%%%%%%%%%%%%
 
 Since $a\equiv x\pmod m$ and $b\equiv y\pmod m$, \[ax+by\equiv x^2+y^2\equiv0\pmod m\] and \[ay-bx\equiv xy-yx\equiv0\pmod m\] so $\frac{ax+by}{m},\frac{ay-bx}{m}\in\mathbb{Z}$ and \[\left(\frac{ax+by}{m}\right)^2+\left(\frac{ay-bx}{m}\right)^2=\frac{km^2p}{m^2}=kp.\]  Now, $\frac{-m}{2}<a\leq\frac{m}{2}$ and $\frac{-m}{2}<b\leq\frac{m}{2}$  imply that $a^2\leq\frac{m^2}{4}$ and $b^2\leq\frac{m^2}{4}$. Thus, $km=a^2+b^2\leq\frac{m^2}{2}$. Thus, $k\leq \frac{m}{2}<m$, but this contradicts that $m$ is the smallest such integer.
 
 Thus, $m=1$.
\end{proof}

We finish with a characterization of which integers are expressible as the sum of two square integers and some examples.

\begin{thm}[Theorem 10.3]
Let $n\in\mathbb{Z}$ with $n>0$. Then $n$ is expressible as the sum of two squares if and only if every prime factor congruent to $3$ modulo  $4$ occurs to an even power in the prime factorization of $n$.
\end{thm}
\begin{proof}
 ($\Rightarrow$) Assume that $p$ is an odd prime number and that $p^{2i+1},i\in\mathbb{Z}$ occurs in the prime factorization of $n$. We will show that $p\equiv 1 \pmod 4$. Since $n$ is expressible as the sum of two squares of integers, there exist $x,y\in\mathbb{Z}$ such that $n=x^2+y^2.$ Let $(x,y)=d, a=\frac{x}{d},b=\frac{y}{d}$ and  $m=\frac{n}{d^2}$. Then $(a,b)=1$ and $a^2+b^2=m$. Let $p^j,j\in\mathbb{Z}$ be the largest power of $p$ dividing $d$. Then $p^{(2i-1)-2j}\mid m$; since $(2i+1)-2j)\geq 1$, we have $p\mid m$. Now, $p\nmid a$ since $(a,b)=1$. Thus, there exists $z\in\mathbb{Z}$ such that $az\equiv b \pmod p$. Then $m=a^2+b^2\equiv a^2+(az)^2\equiv a^2(1+z^2)\pmod p$.
 
 Since $p\mid m$, we have \[a^2(1+z^2)\equiv 0\pmod p\] or $p\mid a^2(1+z^2)$ or $z\equiv -1 \pmod p$. Thus, $-1$ is a quadratic residue modulo $p$, so $p\equiv 1 \pmod 4$. By contrapositive, any prime factor congruent to $3$ modulo $4$ occurs to an even power in the prime factorization of $n$ as desired.
 
 ($\Leftarrow$) Assume that every prime factor of $n$ congruent to $3$ modulo $4$ occurs to an even power in the prime factorization of $n$. Then $n$ can be written as $n=m^2p_1p_2\dots  p_r$ where $m\in\mathbb{Z}$ and $p_1,p_2,\dots,p_r$ are distinct prime numbers equal to $2$ or equivalent to $1$ modulo $4$. Now, $m^2=m^2+0^2$, so is expressible as the sum of two squares, and each $p_1$ is also expressible as the sum of two squares by the theorem labeled Primes as Sums of Squares. Thus, by the first theorem of the day, $n$ is expressible as the sum of two squares.
\end{proof}


\begin{example}
 Determine whether $374^{695}$ is expressible as the sum of two squares. The prime factorization of $374$ is $2*11*17$. So $374^{695}=2^{695}11^{695}17^{695}$ 
 
 
\begin{poll}
 Is $374^{695}$ expressible as the sum of two squares?
\end{poll}
\end{example}

\begin{example}
 Express $4410$ as the sum of two squares by splitting into factors that can be written as the sum of two squares.
 
 The prime factorization of $4410$ is $2*3^2*5*7^2$. We group this into $4410=({2}*{7}^2)({3}^2*{5})={98}*{45}.$ By inspection, the larger of these factors is ${98}={7}^2+{7}^2$ and the smaller is ${45}={6}^2+{3}^2$.
 
 The method from the participation assignment gives $4410={63}^2+{21}^2$.
\end{example}
We finish out the sums of squares section by classifying which integers can be written as the sum of three squares and sum of four squares. These cases are more difficult than the sum of two squares since there is no formula analogous to the April 8 participation assignment.
 %%%%%%%%%%%%%%%%%%%%%%%%%
\section{Friday, April 21: Sums of Four Squares}
%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Sums of Three Squares (20 minutes)}
%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{thm}[Sum of three squares necessary condition]
Let $m,n\in\mathbb{Z}$ with $m,n\geq0$. If $N=4^m(8n+7)$, then $N$ can not be written as the sum of $3$ squares.
\end{thm}
\begin{proof}
 We start by proving the $m=0$ case. In order to get a contradiction, assume that $N=8n+7$ can be written as the sum of three squares. Thus, there exists $x,y,z\in\mathbb{Z}$ such that \[8n+7=x^2+y^2+z^2.\]
 Now, $8n+7\equiv 7\pmod8$ and $x^2+y^2+z^2\not\equiv7\pmod 8$ (by participation assignment), which gives the contradiction we are looking for.

Now we assume $m>0$. and again assume $N=4^m(8n+7)$ can be written as the sum of three squares. As before, there exist $x,y,z\in\mathbb{Z}$ such that \[4^m(8n+7)=x^2+y^2+z^2\] and $x,y,z$ are even (by participation assignment). So there exists $x',y'$ and $z'$ such that $x=2x', y=2y',$ and $z=2z'$. Substituting into our definition of $N$, we get \[4^{m-1}(8n+7)=(x')^2+(y')^2+(z')^2.\]

Repeating  this process $m-1$ times, we find $8n+7$ is expressible as a sum of three squares, a contradiction. Thus, $N=4^m(8n+7)$ cannot be written as the sum of three squares.
\end{proof}

Now, the converse is true. Legendre proved this in 1798, but is much harder to prove, due to the lack of formula like the one from Lemma 10.1. Note that any integer that cannot be written as the sum of three squares cannot be written as the sum of two squares.

\begin{example}
 Determine whether $1584$ is expressible as the sum of three squares. 
 
 The highest power of $4$ that divides $1584$ evenly is $ {16}$, leaving $ {99}\equiv {3} \pmod 8.$ Thus, $1584$ can be written as the sum of three squares:
\begin{poll}
\begin{itemize}
 \item {True}
 \item{False}
 \item{Not enough information}
 \end{itemize}
\end{poll}

Since this also allows us to factor $1584$, we  also know $1584$ can be written as the sum of two squares:
\begin{poll}
\begin{itemize}
 \item{True}
 \item{False}
 \item{Not enough information}
\end{itemize}
\end{poll}
\end{example}
%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Sums of Four Squares (15 minutes)}
%%%%%%%%%%%%%%%%%%%%%%%%%%
We now prove that all positive integers can be written as the sum of four squares. The new few results are similar to the proof of the sum of two squares. Some of these calculations are even more involved, but still use multiplication and factoring. I will upload a scan of the sums of squares section from \emph{Elementary Number Theory} by James K. Strayer. All of the missing calculations are expanding and refactoring polynomial expression. 

\begin{thm}[Euler, Lemma 10.5]
 Let $n_1,n_2\in\mathbb{Z}$ with $n_1,n_2>0$. If $n_1$ and $n_2$ are expressible as the sum of four squares, then so is $n_1n_2$. 
\end{thm}
\begin{proof}
 Let $a,b,c,d,w,x,y,u\in\mathbb{Z}$ such that \[n_1=a^2+b^2+c^2+d^2\] and \[n_1=w^2+x^2+y^2+z^2.\]  Then \[n_1n_2=(aw+bx+cy+dz)^2+(-ax+bw-cz+dy)^2+(-ay+bz+cw-dx)^2+(-az-by+cx+dw)^2 \] as desired.
\end{proof}

\begin{thm}[Also Euler]
 If $p$ is an odd prime number, then there exist $x,y\in\mathbb{Z}$ such that $x^2+y^2+1=kp$ for some $k\in\mathbb{Z}$ with $0<k<p$.
\end{thm}
\begin{proof}
 We consider two cases.
 
{\bf Case 1: $p\equiv 1\pmod 4$}. 
\begin{br}[10 minutes]
 Prove this case.
\end{br}
Then $\left(\frac{-1}{p}\right)=1$, so there exists $x\in\mathbb{Z}$ with $0<x\leq\frac{p-1}{2}$ such that $x^2\equiv -1 \pmod p$. Then, $p\mid x^2+1$, and we have that $x^2+1=kp$ for some $k\in\mathbb{Z}$. Thus, we found $x$ and $y= {0}$. Since $x^2+1$ and $p$ are positive, so is $k$. Also, \[kp=x^2+1<\left(\frac{p}{2}\right)^2+1<p^2\] implies $k<p$.

{\bf Case 2: $p\equiv 3\pmod 4$}. Let $a$ be the least positive quadratic nonresidue modulo $p$. Note that $a\geq2$. Then \[\left(\frac{-a}{p}\right)=\left(\frac{-1}{p}\right)\left(\frac{a}{p}\right)=(-1)(-1)=1\] and so there exists $x\in\mathbb{Z}$ with $0<x\leq\frac{p-1}{2}$ such that $x^2\equiv -a \pmod p$. Now, $a-1$ is positive and less than $a$, then $a-1$ is a quadratic residue modulo $p$. Thus, there exists $y\in\mathbb{Z}$ with $0<y\leq\frac{p-1}{2}$ such that $y^2\equiv a-1 \pmod p$. Thus, \[x^2+y^2+1\equiv (-a)+(a-1)+1\equiv 0 \pmod p\] or, equivalently, $x^2+y^2+1=kp$ for some $k\in\mathbb{Z}$. Again, $k>0$. Furthermore, \[kp=x^2+y^2+1<\left(\frac{p}{2}\right)^2+\left(\frac{p}{2}\right)^2+1<p^2\] implies $k<p$. \qedhere
\end{proof}

We will prove that every prime number can be written as the sum of four squares. 
\begin{thm}[Lagrange, 1770]
 All prime numbers can be written as the sum of four squares.
\end{thm}
\begin{proof}
 When $p=2=1^2+1^2+0^2+0^2$, we are done. In fact, we can also writes a prime $p$ where $p\equiv 1 \pmod 4$ as $p=x^2+y^2+0^2+0^2$, but the following method works for all odd primes. 
 
 Let $m$ be the least positive integer where $x^2+y^2+z^2+w^2=mp$ and $0<m<p$. We want to show that $m=1$. To get a contradiction, assume $m>1$. We consider two cases.

{\bf Case 1:} $m$ even. There are three posibilities: $w,x,y,z$ are all even;  $w,x,y,z$ are all odd; two of $w,x,y,z$ are odd and the other two are even. In all three cases, we can assume $w\equiv x \pmod 2$ and $y\equiv z \pmod 2$. 
Then $\frac{w+x}{2},\frac{w-x}{2},\frac{y+z}{2},\frac{y-z}{2}$ are integers and \[\left(\frac{w+x}{2}\right)^2+\left(\frac{w-x}{2}\right)^2+\left(\frac{y+z}{2}\right)^2+\left(\frac{y-z}{2}\right)^2=\frac{mp}{2}\] which contradicts the fact that $m$ is minimal.
 

{\bf Case 2:} $m$ is odd.  Skip! Repeat argument that $p\equiv 1 \pmod 4$ can be written as the sum of two squares.

Then $m\geq 3.$ Let $a,b,c,d\in\mathbb{Z}$ such that 
\begin{align*}
&a\equiv w\pmod m, \frac{-m}{2}<a<\frac{m}{2}\\
&b\equiv x\pmod m, \frac{-m}{2}<b<\frac{m}{2}\\
&c\equiv y\pmod m, \frac{-m}{2}<c<\frac{m}{2}\\
&d\equiv z\pmod m, \frac{-m}{2}<d<\frac{m}{2}.
\end{align*}
Then $a^2+b^2+c^2+d^2\equiv w^2+x^2+y^2+z^2\equiv mp\equiv 0\pmod m$ and so there exists $k\in\mathbb{Z}$ with $k>0$ such that $a^2+b^2+c^2+d^2=km$.
Now \[(a^2+b^2+c^2+d^2)( w^2+x^2+y^2+z^2)=(km)(mp)=km^2p.\]
By theorem 2 from today, we can rewrite $a^2+b^2+c^2+d^2)( w^2+x^2+y^2+z^2)$ as the sum of four squares 
$(aw+bx+cy+dz)^2+(-ax+bw-cz+dy)^2+(-ay+bz+cw-dx)^2+(-az-by+cx+dw)^2=km^2p$. Since $a\equiv w\pmod m, b\equiv x\pmod m, c\equiv y\pmod m, \frac{-m}{2}<c<\frac{m}{2}, d\equiv z\pmod m, \frac{-m}{2}<d<\frac{m}{2},$ we have 
\begin{align*}
 aw+bx+cy+dz\equiv w^2+x^2+y^2+z^2\equiv 0 \pmod m\\
-ax+bw-cz+dy\equiv -wx+xw-yz+zy\equiv 0\pmod m\\
-ay+bz+cw-dx\equiv -wy+yw+xz-zx\equiv 0\pmod m\\
-az-by+cx+dw\equiv -wx+zw-xy+yx\equiv 0\pmod m
\end{align*}
Let $W=\frac{w^2+x^2+y^2+z^2}{m}, X=\frac{-wx+xw-yz+zy}{m}, Y=\frac{-wy+yw+xz-zx}{m}, Z=\frac{-wx+zw-xy+yx}{m}$. Then $W^2+X^2+Y^2+Z^2=\frac{km^2p}{m^2}=kp.$ Since $\frac{-m}{2}<a,b,c,d<\frac{m}{2},$ then $a^2,b^2,c^2,d^2<\frac{m^2}{4}$. Thus, \[km=a^2+b^2+c^2+d^2<\frac{4m^2}{4}\] and $k<m$. This contradicts that $m$ is the smallest such integers.

Thus, $m=1, w^2+x^2+y^2+z^2=p$.
\end{proof}

\begin{thm}[Lagrange, Theorem 10.6] All positive integers can be written as the sum of four squares.
\end{thm}
\begin{proof}
 Let $n\in\mathbb{Z}$ with $n>1$. If $n=1=1^2+0^2+0^2+0^2$. If $n>1$, then $n$ is the product of primes by the Fundamental Theorem of Arithmetic. By the previous theorem, every prime number can be written as the sum of four squares. By theorem 2 from today, $n$ is can be written by the sum of four squares.
\end{proof}

We finish this section with a few famous problems.
\begin{example}[Waring's Problem, 1770]
 Let $k\in\mathbb{Z}$ with $k>0$. Does there exist a minimum integer $g(k)$ such that every positive integer can be written as the sum of at most $g(k)$ nonnegative integers to the $k^{th}$ power?
 \end{example}
 For example, $g(1)= {1}$. Today we showed that $g(2)= {4}$. The next step would be to find if $g(3)$ exists and what it equals.
 
 
\begin{thm}[Hilbert, 1906]
 Let $k\in\mathbb{Z}$ with $k>0$. There exists a minimal integer $g(k)$ such that every positive integer can be written as the sum of at most $g(k)$ nonnegative integers to the $k^{th}$ power.
\end{thm}
The proof of Hilbert's theorem does not provide a formula for $g(k)$, merely proves it exists. Numerical evidence suggests $g(k)=\left\lfloor\left(\frac{3}{2}\right)^k\right\rfloor+2^k-2$. It's been proven that there are only finitely many (or 0) $k$ where the formula does not hold, and the formula holds when $k\leq 471,600,000$. Thus, $g(3)= {9},g(4)=19,$ and $g(5)=37$. Proofs of these facts come from analytic number theory.

\end{document}