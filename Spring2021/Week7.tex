\documentclass[letterpaper, 11 pt]{article}
\input{lessonplanheader}


\newcommand{\ord}{\operatorname{ord}}

\title{Week 7--MATH 4573 Elementary Number Theory}

\begin{document}

\maketitle
\tableofcontents
%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Monday, February 22: Congruences with a Prime-power Modulus}
%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%

Reading: Section 4.1 of Jones and Jones. Note that we have now covered a lot of this material in the readings from Pommersheim, Marks, and Flapan.

{\bf Turn in:} Exercise 4.2.
%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Quadratic polynomials mod $n$ (15 minutes)}
%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{br}[10 minutes, check in, potentially additional 5 minutes]
Prove the $\Z_p$ version of the quadratic  formula. 

 Let $p>2$ be prime, and $a,b,c\in\Z_p$ where $a\not\equiv 0$. Consider the polynomial congruence \[ax^2+bx+c\equiv0\pmod p.\tag{$\bigstar\bigstar$}\] Let $d\in \Z_p$ where $d\equiv b^2-4ac \pmod p$. 
\begin{enumerate}
 \item If there exists $s\in\Z_p$ such that $s^2=d$ (ie, $s^2\equiv d\pmod p$), then the rational solutions to $\bigstar\bigstar$ are \[x\equiv(-b+s)(2a)^{-1}\pmod p\quad\textnormal{and}\quad x\equiv(-b-s)(2a)^{-1}\pmod p,\] where $(2a)^{-1}$ denotes the multiplicative inverse of $2a \pmod p$.% If $2a\mid -b-s$ or $2a\mid -b+s$, there are integer solutions.
 \item If no such $s$ exists, there is no solution in $\Z_p$.
\end{enumerate}

\end{br}

What happens for composite modulus? 
\begin{cb}
Which steps might not work for composite modulus?\end{cb}
\begin{solution}
 Multiplicative inverses may not exist.
\end{solution}
There may not be a multiplicative inverse. On the reading, we saw that $x^2\equiv 1 \pmod 8$ has four incongruent solutions. From the very end of Section 2.3, we have that we can break composite cases into prime power moduli (like mod 8).
%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{The arithmetic of $\Z_p$ (30 minutes)}
%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{defn}
 Let $f(x) = a_nx^n + a_{n-1}x^{n-1} + \cdot + a_1x + a_0.$ The degree of the polynomial mod $m$ is the largest
integer $j$ such that $a_j\not\equiv 0 \pmod m.$ If all of the $a_i\equiv 0 \pmod m.$, then the degree is 0.
\end{defn}

The degree of the polynomial mod $m$ is not the same as the degree of the polynomial over $\Z.$ For example,
$f(x) = 6x^3 +3x^2 + 1$ has degree 3 over the integers and mod 5, but degree 2 mod 6 and mod 2.




\begin{thm}[Theorem 4.1, Lagrange]
Let $p$ be a prime number and let \[f(x)=a_nx^n+a_{n-1}x^{n-1}+\cdots+a_1x+a_0\] be a polynomial of degree $n\geq 0$ with integral coefficients where $p\nmid a_n$.  Then the congruence \[f(x)\equiv 0 \pmod p\] has at most $n$ incongruent solutions mod $p$ (in other words, at most $n$ solutions in $\Z_p$).
\end{thm}
\begin{proof}
 We are going to use induction on the degree $n$. If $n=0$, then $f(x)\equiv a_0\equiv 0\pmod p$ has no (ie, 0) solutions since we assumed $p\nmid a_0$. For $n=1$, we have that $f(x)=a_1x+a_0$ where $p\nmid a_1$. Since $p$ is prime, this guarantees $(a_1,p)=1$ and $a_1x\equiv -a_0\pmod p$ has exactly one incongruent solution by Theorem 3.7, so the theorem holds for $n=1$.
 
 Next, we induct. Assume that the theorem is true for all $n=k\geq 1$. Then we need to show that the theorem is true for $n=k+1$. Let $f(x)=a_{k+1}x^{k+1}+a_kx^k+\cdots a_1 x+a_0$ where $p\nmid a_{k+1}$. If there are no solutions to $f(x)\equiv 0 \pmod n$, then the theorem is true and we are done. 
 
 If $f(x)\equiv 0 \pmod p$ has at least one solution $a_1$, then we can factor out $x-a_1$. However, proving this is difficult, and we need to show that modulo a prime is enough to say we have reduced the degree. We are going to use a different method.
  
 Let's relate this to the proof we have already seen: assume there are $k+2$ distinct roots mod $p$, and call them $d_1,d_2,\dots,d_{k+2}$. Then we define $h(x)=f(x)-a^{k+1}(x-d_1)(x-d_2)\cdots(x-d_{k+1})$. Then $h(x)$ has at least $k+1$ distinct roots mod $p$. 
 
 {\bf Case1:} If every coefficient of $h(x)$ is  $0 \pmod p$, then $h(x)\equiv 0 \pmod p$ for all integers $x$. Then $f(d_{k+2})\equiv 0 \pmod p$ and $h(d_{k+2})\equiv 0 \pmod p$ implies $d_{k+2}$ is a root of $a^{k+1}(x-d_1)(x-d_2)\cdots(x-d_{k+1})$ mod $p$. But this is a contradiction, since none of the factors are 0 and $p$ is prime. 
 
 {\bf Case 2:} $h(x)$ is not identically 0. Then $h(x)$ has degree less $n=k+1$ mod $p$. By induction hypothesis, $h(x)$ has at more $k$ roots, so $f(x)$ has at more $k$ roots.
\end{proof}

\begin{br}[Exercise 4.1, 5 minutes]
 Find the roots of the polynomial $f(x) = x^2 +1$ in $\Z_p$ for each prime $p \leq 17$. Make a conjecture about how many roots $f(x)$ has in $\Z_p$ for each prime $p.$
\end{br}

\begin{example}[Example 4.1]
 Let us find the least nonnegative residue of $2^{68} \pmod{19}$.
 
 Sice $p=19$ is prime and $19\nmid 2$, Fermat's Little Theorem $2^{18}\equiv 1\pmod{19}$, and $68=18*3+14$, so
 \[2^{68}\equiv (2^{18})^32^{14}\equiv 2^{14} \pmod {19}\]
 
 Here we can use a method called repeated squaring. Since $2^4\equiv 16\equiv -3 \pmod{19}$, \[2^{12}\equiv (-3)^3\equiv -27\equiv -8\pmod{19}.\]
 We get that  \[2^{68}\equiv 2^{14} \equiv -8*2^2\equiv 6\pmod {19}\]

\end{example}
 
\begin{br}[5 minutes]
 Let us find the least nonnegative residue of $6^{4162}  \pmod{41}$.
\[64162 \equiv 6^{4000+160+2} \equiv 6^{4000}6^{160}6^2 \equiv (6^{40})^{10}(6^{40})^46^2 \equiv 1^{10}1^4 36 \equiv 36 \pmod{41}\]
\end{br}

\begin{thm}[Theorem 4.6]
 Let $p$ be an odd prime. Then the quadratic congruence $x^2+1\equiv 0 \pmod p$ has a solution if and only if $p\equiv 1 \pmod 4$.
\end{thm}
\begin{proof}
 Suppose $p$ is an odd prime, and let $k=\frac{p-1}{2}$. Consider the product \[(p-1)!=1*2*\cdots*k*(k+1)*\cdots*(p-2)(p-1).\]
Note that $p-1\equiv -1\pmod p,p-2\equiv -2\pmod p, \dots, k+1=p-k\equiv -k\pmod p$. Then \[(p-1)!\equiv k! (-1)^k(k!)\pmod p.\]
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Friday, February 26: Primality testing}
%%%%%%%%%%%%%%%%%%%%%%%%%%
Turn in:
\begin{enumerate}
 \item Reflect on how the article on classroom mindset relates to this course. This could be the course content, the course structure, mathematics classes in general, college in general...However you see the article relating to our course.

\item What is the most confusing thing we have learned so far?

\item Is there anything we have learned so far that surprised you?
\item What was a problem or concept that you really struggled with, but now understand? 
\item What is something that you have done this semester that makes you feel like a mathematician? It does not have to be limited to this course.

\end{enumerate}
%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Updates and reminders (15 minutes)}
%%%%%%%%%%%%%%%%%%%%%%%%%%
A few things that I've talked about in office hours but want to make sure the whole class hears. Sometimes it can be better to use share the framing or phrasing your classmates use, as it's probably a bit closer to how you think about things.

On Gradescope, if there is not anything in the "score" section, then the problem was not assigned a score. Normally, I catch this on the first submission, and I will work to be better on the resubmits. If you do not have a score, you can use the regrade request or email me. 

For the resubmissions, I grade it as an entirely new assignment. The only difference is at the end, I open the excel file and update scores. If a problem is graded as one problem the first time, it will be graded as one problem the second time. Sometimes, if you have a difficult to read submission or confusing wording, it can be challenging to see where feedback is necessary. The proofs and justifications in this course are more complicated and nuanced that in non-proofs courses, and it can be hard to see exactly where the confusion is. When I submit papers, sometimes I get back referee reports that says I didn't explain something, or completely misunderstands what I was trying to say. I try to take a bit, and then see how the phrasing what unclear. 

Someone also suggested thinking about explaining your reasoning as the grader has not read the section. This could be a useful framing for some of you. I had been avoiding similar phrasing since it was resulting in 2-3 page answers last semester, but if that helps, use it. 

There was also a good office hours question about how to go about solving problems and proofs. Even if the problem is not in the ``modifying proofs" section, the proofs of theorems from class or the book can be very useful outlines or have useful tricks. There are also answers in the back of the book for the exercises that come from the book. Now, you should not be copying the solutions word for word, but in the process of trying to rephrase things, you are going to need to understand what is happening. 

%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Finishing polynomial roots (30 minutes)}
%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{br}[Exercise 4.1, 5 minutes]
 Find the roots of the polynomial $f(x) = x^2 +1$ in $\Z_p$ for each prime $p \leq 17$. Make a conjecture about how many roots $f(x)$ has in $\Z_p$ for each prime $p.$
\end{br}
\begin{solution}
From Theorem 4.1, we know that there are at most $2$ roots for each modulus. Since we have not yet proven Homework 6 problem 5, then best approach is guess-and-check brute force.

 For $p=2, x\equiv 1 \pmod 2$. 
 
 For $p=5, x\equiv2 \pmod 5$ and $x\equiv -2 \equiv 3 \pmod 5$.
 
For $p=13, x\equiv5 \pmod{13}$ and $x\equiv -5 \equiv 8 \pmod{13}$.
  
For $p=17, x\equiv4 \pmod {17}$ and $x\equiv -4 \equiv 13 \pmod{17}$.
   
 
 For $p=3,7, 11$, there are no solutions. This can be seen through a guess and check brute force.
\end{solution}

This brings us to the next theorem:

\begin{thm}[Theorem 4.6]
 Let $p$ be an odd prime. Then the quadratic congruence $x^2+1\equiv 0 \pmod p$ has a solution if and only if $p\equiv 1 \pmod 4$.
\end{thm}
\begin{proof}
 Suppose $p$ is an odd prime, and let $k=\frac{p-1}{2}$. Consider the product \[(p-1)!=1*2*\cdots*k*(k+1)*\cdots*(p-2)(p-1).\]
Note that $p-1\equiv -1\pmod p,p-2\equiv -2\pmod p, \dots, p-k\equiv -k\pmod p$, and $p-k=\frac{2p-p+1}{2}=\frac{p-1+2}{2}=k+1$. Then \[-1\equiv(p-1)!\equiv k! (-1)^k(k!)\pmod p.\] 

If $x=k!$, then $(-1)^kx^2+1\equiv 0 \pmod p$, by rewriting the convergence. When $k$ is even, this is the congruence $x^2+1\equiv 0 \pmod p$. We also know that when $k$ is even, there exists some $m$ such that $2m=k=\frac{p-1}{2}$. Thus, $p=4m+1$. Therefore, we have found a solution to $x^2+1\equiv 0 \pmod p$ when $p\equiv 1 \pmod 4$.

Now we must check that there is not some other solution with $p\equiv 3 \pmod 4$. Now, in both cases, we know that Fermat's Little Theorem (Theorem 4.3) says that $x^{p-1}\equiv x^{2k}\equiv 1 \pmod p$. 
In the case that $p\equiv 3 \pmod 4,$ we know that $k=\frac{p-1}{2}$ is odd. By rewriting $(-1)^kx^2+1\equiv 0 \pmod p$, we see that $1\equiv x^2 \mod p$. Thus, $x^{2k}\equiv 1^k \pmod p$, which contradicts Fermat's Little Theorem. Thus, so solutions exist.
\end{proof}
%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Primality Testing (10 minutes)}
%%%%%%%%%%%%%%%%%%%%%%%%%%

We have seen a lot of places where it is useful to have prime numbers. We need to be able to determine if a number is prime or composite. Factoring is slow, so we would like a better algorithm. 

\begin{defn}
 If $a^{n-1}\not\equiv 1 \pmod n$, we know that $n$ is composite. In this case, we say that $a$ is a \emph{Fermat witness to the compositeness of $n$.}
\end{defn}

\begin{br}[3 minutes]
Is there a Fermat witness to the compositeness of 4? 
\end{br}
\begin{solution}
$2^3\equiv 0 \pmod 4$ is a witness. $3^3\equiv 3 \pmod 4$.
\end{solution}
\end{document}




\begin{br}[5 minutes]A \emph{nontrivial} factor of a number $n$ is a factor that is not equal to $\pm 1$ or $\pm n$. It is nontrivial because all numbers $n$ have $\pm 1$ and $\pm n$ as factors. 
Are all \emph{nontrivial} factors of positive composite integers $n$ Fermat witnesses to the compositeness of $n$? Prove or provide counterexample.
\end{br}
\begin{solution}
 %Let $a$ be a factor of $n$. If $a^{n-1}\equiv 1 \pmod n$, then $n\mid a^{n-1}-1$. Since division is transitive, $a\mid a^{n-1}-1$. Since $a\mid a^{n-1}$, we must have that $a\mid 1$. Thus, the only factor of $n$ that is not a Fermat witness is $\pm 1$.
 \end{solution}
%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Carmichael Numbers (25 minutes)}
%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{defn}
 A \emph{Carmichael number} is a composite integer where for every integer $a$ where $(a,n)=1$ implies $a^{n-1}\equiv 1 \pmod n$. 
\end{defn}

The smallest Carmichael number is $561=3*11*17$. There are only 43 Carmichael numbers less than 1 million, but Alford, Granville, and Pomerance proved that there are infinitely many in 1994.

\begin{thm}
 Let $n$ be a positive composite integer. Then $n$ is a Carmichael number if and only if 
\begin{enumerate}
 \item For every prime $p$ such that $p\mid n$, we have $p-1\mid n-1$.
 \item $n$ is the product of distinct primes (ie, $n$ is \emph{square free} meaning no prime is raised to a power higher than 1).
\end{enumerate}
\end{thm}
\begin{proof}
 ($\Leftarrow$) Let $n$ be composite and assume (1) and (2) are true. Then $n=p_1p_2\dots p_s$ where the $p_j$ are distinct and $p_j-1\mid n-1$. 
 
 In order to show that $n$ is a Carmichael number, we need to show that $a^{n-1}\equiv 1 \pmod n$ for every integer $a$ where $(a,n)=1$. If $(a,n)=1$, then $a^{p_j-1}\equiv 1 \pmod{p_j}$ by Fermat's Little Theorem. Since $p_j-1\mid n-1$, there exists a positive integer $k_j$ such that $(p_j-1)k_j=n-1$. Thus, $a^{n-1}\equiv a^{(p_j-1)k_j}\equiv 1\equiv 1^{k_j}\equiv 1 \equiv \pmod{p_j}$. Thus, we have a system of congruences 
 
\begin{align*}
 x&=a^{n-1}\equiv 1 \pmod{p_1}\\
 x&=a^{n-1}\equiv 1 \pmod{p_2}\\
& \vdots\\
 x&=a^{n-1}\equiv 1 \pmod{p_s}.
\end{align*}
By the Chinese remainder theorem, there exists a unique solution to this system of congruences modulo $n$, we want to show that the solution is $1 \pmod n$. There is a one-to-one correspondence between systems of congruences modulo $p_1,p_2,\dots, p_s$ and possible solutions modulo $n$. 
By the corollary to the Chinese remainder theorem, there is a unique system of congruences modulo $p_1,p_2,\dots, p_s$ with solution $x\equiv 1 \pmod n$. By Theorem 2.1 part 4, since each $p_j\mid n$, if $x\equiv 1 \pmod n$, then $x\equiv 1 \pmod{p_j}$. Thus, $x=a^{n-1}\equiv 1 \pmod n$.

($\Rightarrow$) This is much harder. More primality testing and proving this theorem is a possible optional topic.
\end{proof}

We have a related test:
\begin{thm}
 Let $n$ be a positive integer. If an integer $a$ exists such that $a^{n-1} \equiv 1 \pmod n$ and $a^{(n-1)/q}\not\equiv 1\pmod n$ for all prime divisors $q$ of $n-1$, then $n$ is prime.
\end{thm}
\begin{proof}
 Since $a^{n-1} \equiv 1 \pmod n$, we have that $\ord_n(a)\mid n-1$, so there exists positive integer $k$ such that $n-1=k \ord_n(1)$. We want to show that $k=1$. In order to get a contradiction, assume that $\ord_n(1)\neq n-1$, so $k>1$. Let $q$ be a prime divisor of $k$, and thus $n-1$. Thus,  \[a^{(n-1)/q}=a^{k(\ord_n(a))/q}=(a^{\ord_n(a)})^{k/q}\equiv 1 \pmod n.\] This is a contradiction. Now, $\ord_n(a)\leq \phi(n)\leq n-1$. Since $ \ord_n(a)=n-1$, we have that $\phi(n)=n-1$ and thus $n$ is prime.
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Computational Complexity of Factoring (20 minutes)}
%%%%%%%%%%%%%%%%%%%%%%%%%%
We will finish by looking at the computational complexity of factoring 

\begin{br}[Rest of class]
 \begin{enumerate}
 \item\label{factoring} Let $n$ be a positive integer, and suppose $x$ and $y$ are integers such that $x^2\equiv y^2\pmod n$ but $x\not\equiv \pm y \pmod n$. Prove that $d=\gcd(x-y,n)$ and $e=\gcd(x+y,n)$ are factors of $n$ that are not equal to $\pm 1$ or $\pm n$.

	\item  We are going to use problem \ref{factoring} to explore how finding the order of an integer modulo $n$ is at least as computationally complex as factoring.
\begin{enumerate}
\item Suppose you wish to factor $713$. Use that $3$ has order $330$ modulo $713$, $330=2(165)$, and $3^{165}\equiv 185 \pmod{713}$. Let $x=185$. How do you know that $x^2\equiv 1 \pmod{713}$? Use the previous problem to find a factor of $n$ using the Euclidean algorithm to find the greatest common divisor.
\item Suppose $a$ is an integer where $(a,n)=1$ and $\ord_n(a)=r$. Assume that $r$ is even, and let $x=a^{r/2}$. Show that $x^2\equiv 1 \pmod n$, but $x\not\equiv 1 \pmod n$.  
\item Now assume that $x$ in the previous problem is not equivalent to $-1$ modulo $n$. How does this help find a factor of $n$?
\end{enumerate}
\end{enumerate}

\end{br}
\end{document}